layui.use(["layer","jquery","cropper"],function(){var b=layui.jquery;b(document).ready(function(){a()});function a(){var d=b(".img-crop > img");b(d).cropper({aspectRatio:1/1,preview:".img-preview",done:function(){}});var c=b("#inputImage");window.FileReader?c.change(function(){var h,g=new FileReader,f=this.files;f.length&&(h=f[0],/^image\/\w+$/.test(h.type)?(g.readAsDataURL(h),g.onload=function(){c.val(""),d.cropper("reset",!0).cropper("replace",this.result)}):showMessage("请上传图片！"))}):c.addClass("hide"),b("#upload").click(function(){b(this).attr({disabled:"disabled"});b(this).text("上传中");alert(d.cropper("getDataURL"));b("#upload").removeAttr("disabled");b(this).text("确认保存")}),b("#zoomIn").click(function(){d.cropper("zoom",0.1)}),b("#zoomOut").click(function(){d.cropper("zoom",-0.1)}),b("#rotateLeft").click(function(){d.cropper("rotate",90)}),b("#rotateRight").click(function(){d.cropper("rotate",-90)}),b("#setDrag").click(function(){d.cropper("setDragMode","crop")})}});