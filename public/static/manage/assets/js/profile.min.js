layui.use(["element","form","jquery","cropper"],function(){var c=layui.element(),d=layui.form(),b=layui.layer,e=layui.jquery;e(document).ready(function(){a()});function a(){var g=e(".img-crop > img");e(g).cropper({aspectRatio:1/1,preview:".img-preview",done:function(){}});var f=e("#inputImage");window.FileReader?f.change(function(){var k,j=new FileReader,h=this.files;h.length&&(k=h[0],/^image\/\w+$/.test(k.type)?(j.readAsDataURL(k),j.onload=function(){f.val(""),g.cropper("reset",!0).cropper("replace",this.result)}):showMessage("请上传图片！"))}):f.addClass("hide"),e("#upload").click(function(){e(this).attr({disabled:"disabled"});e(this).text("上传中");alert(g.cropper("getDataURL"));e("#upload").removeAttr("disabled");e(this).text("确认保存")}),e("#zoomIn").click(function(){g.cropper("zoom",0.1)}),e("#zoomOut").click(function(){g.cropper("zoom",-0.1)}),e("#rotateLeft").click(function(){g.cropper("rotate",90)}),e("#rotateRight").click(function(){g.cropper("rotate",-90)}),e("#setDrag").click(function(){g.cropper("setDragMode","crop")})}d.verify({password:function(f){if(e("input[name=password]").val()!==f){return"两次密码不一致！"}}});d.on("submit(formInfo)",function(f){b.msg(JSON.stringify(f.field));return false});d.on("submit(formPassword)",function(f){b.msg(JSON.stringify(f.field));return false})});