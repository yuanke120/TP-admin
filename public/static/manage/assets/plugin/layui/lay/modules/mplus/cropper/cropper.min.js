/*!
 * Cropper v0.7.6-beta
 * https://github.com/fengyuanchen/cropper
 *
 * Copyright 2014 Fengyuan Chen
 * Released under the MIT license
 */
;layui.define("jquery",function(a){var b=layui.jquery;!function(c){"function"==typeof define&&define.amd?define(["jquery"],c):c("object"==typeof a?require("jquery"):b)}(function(aG){var aF=aG(window),aE=aG(document),aD=window.location,aC=!0,aB=!1,aA=null,az=0/0,ay=1/0,ax="undefined",aw="directive",av=".cropper",au=/^(e|n|w|s|ne|nw|sw|se|all|crop|move|zoom)$/,at=/^(x|y|width|height)$/,ar=/^(naturalWidth|naturalHeight|width|height|aspectRatio|ratio|rotate)$/,aq="cropper-modal",ap="cropper-hidden",ao="cropper-invisible",an="cropper-move",am="cropper-crop",al="cropper-disabled",ak="mousedown touchstart",aj="mousemove touchmove",ai="mouseup mouseleave touchend touchleave touchcancel",ah="wheel mousewheel DOMMouseScroll",ag="resize"+av,af="dblclick",ae="build"+av,ad="built"+av,ac="dragstart"+av,ab="dragmove"+av,aa="dragend"+av,Z=function(c){return"number"==typeof c},Y=function(d,e){this.element=d,this.$element=aG(d),this.defaults=aG.extend({},Y.DEFAULTS,aG.isPlainObject(e)?e:{}),this.$original=aA,this.ready=aB,this.built=aB,this.cropped=aB,this.rotated=aB,this.disabled=aB,this.replaced=aB,this.init()},X=Math.round,W=Math.sqrt,V=Math.min,U=Math.max,T=Math.abs,S=Math.sin,R=Math.cos,Q=parseFloat;Y.prototype={constructor:Y,support:{canvas:aG.isFunction(aG("<canvas>")[0].getContext)},init:function(){var c=this.defaults;aG.each(c,function(d,e){switch(d){case"aspectRatio":c[d]=T(Q(e))||az;break;case"autoCropArea":c[d]=T(Q(e))||0.8;break;case"minWidth":case"minHeight":c[d]=T(Q(e))||0;break;case"maxWidth":case"maxHeight":c[d]=T(Q(e))||ay}}),this.image={rotate:0},this.load()},load:function(){var e,o,n=this,m=this.$element,l=this.element,k=this.image,j="";m.is("img")?o=m.prop("src"):m.is("canvas")&&this.support.canvas&&(o=l.toDataURL()),o&&(this.replaced&&(k.rotate=0),this.defaults.checkImageOrigin&&(m.prop("crossOrigin")||this.isCrossOriginURL(o))&&(j=" crossOrigin"),this.$clone=e=aG("<img"+j+' src="'+o+'">'),e.one("load",function(){k.naturalWidth=this.naturalWidth||e.width(),k.naturalHeight=this.naturalHeight||e.height(),k.aspectRatio=k.naturalWidth/k.naturalHeight,n.url=o,n.ready=aC,n.build()}),e.addClass(ao).prependTo("body"))},isCrossOriginURL:function(d){var c=d.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return !c||c[1]===aD.protocol&&c[2]===aD.hostname&&c[3]===aD.port?aB:aC},build:function(){var c,i,h=this.$element,e=this.defaults;this.ready&&(this.built&&this.unbuild(),h.one(ae,e.build),c=aG.Event(ae),h.trigger(c),c.isDefaultPrevented()||(this.$cropper=i=aG(Y.TEMPLATE),h.addClass(ap),this.$clone.removeClass(ao).prependTo(i),this.rotated||(this.$original=this.$clone.clone(),this.$original.addClass(ap).prependTo(this.$cropper),this.originalImage=aG.extend({},this.image)),this.$container=h.parent(),this.$container.append(i),this.$canvas=i.find(".cropper-canvas"),this.$dragger=i.find(".cropper-dragger"),this.$viewer=i.find(".cropper-viewer"),e.autoCrop?this.cropped=aC:this.$dragger.addClass(ap),e.dragCrop&&this.setDragMode("crop"),e.modal&&this.$canvas.addClass(aq),!e.dashed&&this.$dragger.find(".cropper-dashed").addClass(ap),!e.movable&&this.$dragger.find(".cropper-face").data(aw,"move"),!e.resizable&&this.$dragger.find(".cropper-line, .cropper-point").addClass(ap),this.$scope=e.multiple?this.$cropper:aE,this.addListeners(),this.initPreview(),this.built=aC,this.update(),h.one(ad,e.built),h.trigger(ad)))},unbuild:function(){this.built&&(this.built=aB,this.removeListeners(),this.$preview.empty(),this.$preview=aA,this.$dragger=aA,this.$canvas=aA,this.$container=aA,this.$cropper.remove(),this.$cropper=aA)},update:function(c){this.initContainer(),this.initCropper(),this.initImage(),this.initDragger(),c?(this.setData(c,aC),this.setDragMode("crop")):this.setData(this.defaults.data)},resize:function(){clearTimeout(this.resizing),this.resizing=setTimeout(aG.proxy(this.update,this,this.getData()),200)},preview:function(){var h=this.image,m=this.dragger,l=h.width,k=h.height,j=m.left-h.left,i=m.top-h.top;this.$viewer.find("img").css({width:X(l),height:X(k),marginLeft:-X(j),marginTop:-X(i)}),this.$preview.each(function(){var c=aG(this),d=c.width()/m.width;c.find("img").css({width:X(l*d),height:X(k*d),marginLeft:-X(j*d),marginTop:-X(i*d)})})},addListeners:function(){var d=this.defaults;this.$element.on(ac,d.dragstart).on(ab,d.dragmove).on(aa,d.dragend),this.$cropper.on(ak,this._dragstart=aG.proxy(this.dragstart,this)).on(af,this._dblclick=aG.proxy(this.dblclick,this)),d.zoomable&&this.$cropper.on(ah,this._wheel=aG.proxy(this.wheel,this)),this.$scope.on(aj,this._dragmove=aG.proxy(this.dragmove,this)).on(ai,this._dragend=aG.proxy(this.dragend,this)),aF.on(ag,this._resize=aG.proxy(this.resize,this))},removeListeners:function(){var c=this.defaults;this.$element.off(ac,c.dragstart).off(ab,c.dragmove).off(aa,c.dragend),this.$cropper.off(ak,this._dragstart).off(af,this._dblclick),c.zoomable&&this.$cropper.off(ah,this._wheel),this.$scope.off(aj,this._dragmove).off(ai,this._dragend),aF.off(ag,this._resize)},initPreview:function(){var c='<img src="'+this.url+'">';this.$preview=aG(this.defaults.preview),this.$viewer.html(c),this.$preview.html(c).find("img").css("cssText","min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;")},initContainer:function(){var c=this.$container;this.container={width:U(c.width(),300),height:U(c.height(),150)}},initCropper:function(){var e,d=this.container,f=this.image;f.naturalWidth*d.height/f.naturalHeight-d.width>=0?(e={width:d.width,height:d.width/f.aspectRatio,left:0},e.top=(d.height-e.height)/2):(e={width:d.height*f.aspectRatio,height:d.height,top:0},e.left=(d.width-e.width)/2),this.$cropper.css({width:X(e.width),height:X(e.height),left:X(e.left),top:X(e.top)}),this.cropper=e},initImage:function(){var e=this.image,g=this.cropper,f={_width:g.width,_height:g.height,width:g.width,height:g.height,left:0,top:0,ratio:g.width/e.naturalWidth};this.defaultImage=aG.extend({},e,f),e._width!==g.width||e._height!==g.height?aG.extend(e,f):(e=aG.extend({},f,e),this.replaced&&(this.replaced=aB,e.ratio=f.ratio)),this.image=e,this.renderImage()},renderImage:function(d){var c=this.image;"zoom"===d&&(c.left-=(c.width-c.oldWidth)/2,c.top-=(c.height-c.oldHeight)/2),c.left=V(U(c.left,c._width-c.width),0),c.top=V(U(c.top,c._height-c.height),0),this.$clone.css({width:X(c.width),height:X(c.height),marginLeft:X(c.left),marginTop:X(c.top)}),d&&(this.defaults.done(this.getData()),this.preview())},initDragger:function(){var g,k=this.defaults,j=this.cropper,i=k.aspectRatio||this.image.aspectRatio,h=this.image.ratio;g=j.height*i-j.width>=0?{height:j.width/i,width:j.width,left:0,top:(j.height-j.width/i)/2,maxWidth:j.width,maxHeight:j.width/i}:{height:j.height,width:j.height*i,left:(j.width-j.height*i)/2,top:0,maxWidth:j.height*i,maxHeight:j.height},g.minWidth=0,g.minHeight=0,k.aspectRatio?(isFinite(k.maxWidth)?(g.maxWidth=V(g.maxWidth,k.maxWidth*h),g.maxHeight=g.maxWidth/i):isFinite(k.maxHeight)&&(g.maxHeight=V(g.maxHeight,k.maxHeight*h),g.maxWidth=g.maxHeight*i),k.minWidth>0?(g.minWidth=U(0,k.minWidth*h),g.minHeight=g.minWidth/i):k.minHeight>0&&(g.minHeight=U(0,k.minHeight*h),g.minWidth=g.minHeight*i)):(g.maxWidth=V(g.maxWidth,k.maxWidth*h),g.maxHeight=V(g.maxHeight,k.maxHeight*h),g.minWidth=U(0,k.minWidth*h),g.minHeight=U(0,k.minHeight*h)),g.minWidth=V(g.maxWidth,g.minWidth),g.minHeight=V(g.maxHeight,g.minHeight),g.height*=k.autoCropArea,g.width*=k.autoCropArea,g.left=(j.width-g.width)/2,g.top=(j.height-g.height)/2,g.oldLeft=g.left,g.oldTop=g.top,this.defaultDragger=g,this.dragger=aG.extend({},g)},renderDragger:function(){var d=this.dragger,c=this.cropper;d.width>d.maxWidth?(d.width=d.maxWidth,d.left=d.oldLeft):d.width<d.minWidth&&(d.width=d.minWidth,d.left=d.oldLeft),d.height>d.maxHeight?(d.height=d.maxHeight,d.top=d.oldTop):d.height<d.minHeight&&(d.height=d.minHeight,d.top=d.oldTop),d.left=V(U(d.left,0),c.width-d.width),d.top=V(U(d.top,0),c.height-d.height),d.oldLeft=d.left,d.oldTop=d.top,this.dragger=d,this.disabled||this.defaults.done(this.getData()),this.$dragger.css({width:X(d.width),height:X(d.height),left:X(d.left),top:X(d.top)}),this.preview()},reset:function(c){this.cropped&&(c&&(this.defaults.data={}),this.image=aG.extend({},this.defaultImage),this.renderImage(),this.dragger=aG.extend({},this.defaultDragger),this.setData(this.defaults.data))},clear:function(){this.cropped&&(this.cropped=aB,this.setData({x:0,y:0,width:0,height:0}),this.$canvas.removeClass(aq),this.$dragger.addClass(ap))},destroy:function(){var c=this.$element;this.ready&&(this.unbuild(),c.removeClass(ap).removeData("cropper"),this.rotated&&c.attr("src",this.$original.attr("src")))},replace:function(e,m){var l,k=this,j=this.$element,f=this.element;e&&e!==this.url&&e!==j.attr("src")&&(m||(this.rotated=aB,this.replaced=aC),j.is("img")?(j.attr("src",e),this.load()):j.is("canvas")&&this.support.canvas&&(l=f.getContext("2d"),aG('<img src="'+e+'">').one("load",function(){f.width=this.width,f.height=this.height,l.clearRect(0,0,f.width,f.height),l.drawImage(this,0,0),k.load()})))},setData:function(g,m){var l=this.cropper,k=this.dragger,j=this.image,i=this.defaults.aspectRatio;this.built&&typeof g!==ax&&((g===aA||aG.isEmptyObject(g))&&(k=aG.extend({},this.defaultDragger)),aG.isPlainObject(g)&&!aG.isEmptyObject(g)&&(m||(this.defaults.data=g),g=this.transformData(g),Z(g.x)&&g.x<=l.width-j.left&&(k.left=g.x+j.left),Z(g.y)&&g.y<=l.height-j.top&&(k.top=g.y+j.top),i?Z(g.width)&&g.width<=k.maxWidth&&g.width>=k.minWidth?(k.width=g.width,k.height=k.width/i):Z(g.height)&&g.height<=k.maxHeight&&g.height>=k.minHeight&&(k.height=g.height,k.width=k.height*i):(Z(g.width)&&g.width<=k.maxWidth&&g.width>=k.minWidth&&(k.width=g.width),Z(g.height)&&g.height<=k.maxHeight&&g.height>=k.minHeight&&(k.height=g.height))),this.dragger=k,this.renderDragger())},getData:function(f){var e=this.dragger,h=this.image,g={};return this.built&&(g={x:e.left-h.left,y:e.top-h.top,width:e.width,height:e.height},g=this.transformData(g,aC,f)),g},transformData:function(g,k,j){var i=this.image.ratio,h={};return aG.each(g,function(d,c){c=Q(c),at.test(d)&&!isNaN(c)&&(h[d]=k?j?X(c/i):c/i:c*i)}),h},setAspectRatio:function(d){var c="auto"===d;d=Q(d),(c||!isNaN(d)&&d>0)&&(this.defaults.aspectRatio=c?az:d,this.built&&(this.initDragger(),this.renderDragger()))},getImageData:function(){var c={};return this.ready&&aG.each(this.image,function(d,e){ar.test(d)&&(c[d]=e)}),c},getDataURL:function(i,o,n){var m,l=aG("<canvas>")[0],k=this.getData(),j="";return aG.isPlainObject(i)||(n=o,o=i,i={}),i=aG.extend({width:k.width,height:k.height},i),this.cropped&&this.support.canvas&&(l.width=i.width,l.height=i.height,m=l.getContext("2d"),"image/jpeg"===o&&(m.fillStyle="#fff",m.fillRect(0,0,i.width,i.height)),m.drawImage(this.$clone[0],k.x,k.y,k.width,k.height,0,0,i.width,i.height),j=l.toDataURL(o,n)),j},setDragMode:function(f){var e=this.$canvas,j=this.defaults,i=aB,h=aB;if(this.built&&!this.disabled){switch(f){case"crop":j.dragCrop&&(i=aC,e.data(aw,f));break;case"move":h=aC,e.data(aw,f);break;default:e.removeData(aw)}e.toggleClass(am,i).toggleClass(an,h)}},enable:function(){this.built&&(this.disabled=aB,this.$cropper.removeClass(al))},disable:function(){this.built&&(this.disabled=aC,this.$cropper.addClass(al))},rotate:function(d){var c=this.image;d=Q(d)||0,this.built&&0!==d&&!this.disabled&&this.defaults.rotatable&&this.support.canvas&&(this.rotated=aC,d=c.rotate=(c.rotate+d)%360,this.replace(this.getRotatedDataURL(d),!0))},getRotatedDataURL:function(y){var x=aG("<canvas>")[0],w=x.getContext("2d"),v=y*Math.PI/180,u=T(y)%180,t=u>90?180-u:u,s=t*Math.PI/180,r=this.originalImage,q=r.naturalWidth,p=r.naturalHeight,o=T(q*R(s)+p*S(s)),n=T(q*S(s)+p*R(s));return x.width=o,x.height=n,w.save(),w.translate(o/2,n/2),w.rotate(v),w.drawImage(this.$original[0],-q/2,-p/2,q,p),w.restore(),x.toDataURL()},zoom:function(g){var f,j,i,h=this.image;g=Q(g),this.built&&g&&!this.disabled&&this.defaults.zoomable&&(f=h.width*(1+g),j=h.height*(1+g),i=f/h._width,i>10||(1>i&&(f=h._width,j=h._height),this.setDragMode(1>=i?"crop":"move"),h.oldWidth=h.width,h.oldHeight=h.height,h.width=f,h.height=j,h.ratio=h.width/h.naturalWidth,this.renderImage("zoom")))},dblclick:function(){this.disabled||this.setDragMode(this.$canvas.hasClass(am)?"move":"crop")},wheel:function(i){var h,n=i.originalEvent,m=117.25,l=5,k=166.66665649414062,j=0.1;this.disabled||(i.preventDefault(),n.deltaY?(h=n.deltaY,h=h%l===0?h/l:h%m===0?h/m:h/k):h=n.wheelDelta?-n.wheelDelta/120:n.detail?n.detail/3:0,this.zoom(h*j))},dragstart:function(e){var m,l,k,j=e.originalEvent.touches,f=e;if(!this.disabled){if(j){if(k=j.length,k>1){if(!this.defaults.zoomable||2!==k){return}f=j[1],this.startX2=f.pageX,this.startY2=f.pageY,m="zoom"}f=j[0]}if(m=m||aG(f.target).data(aw),au.test(m)){if(e.preventDefault(),l=aG.Event(ac),this.$element.trigger(l),l.isDefaultPrevented()){return}this.directive=m,this.cropping=aB,this.startX=f.pageX,this.startY=f.pageY,"crop"===m&&(this.cropping=aC,this.$canvas.addClass(aq))}}},dragmove:function(g){var k,j,i=g.originalEvent.touches,h=g;if(!this.disabled){if(i){if(j=i.length,j>1){if(!this.defaults.zoomable||2!==j){return}h=i[1],this.endX2=h.pageX,this.endY2=h.pageY}h=i[0]}if(this.directive){if(g.preventDefault(),k=aG.Event(ab),this.$element.trigger(k),k.isDefaultPrevented()){return}this.endX=h.pageX,this.endY=h.pageY,this.dragging()}}},dragend:function(d){var e;if(!this.disabled&&this.directive){if(d.preventDefault(),e=aG.Event(aa),this.$element.trigger(e),e.isDefaultPrevented()){return}this.cropping&&(this.cropping=aB,this.$canvas.toggleClass(aq,this.cropped&&this.defaults.modal)),this.directive=""}},dragging:function(){var F,E=this.directive,D=this.image,C=this.cropper,B=C.width,A=C.height,z=this.dragger,y=z.width,x=z.height,w=z.left,v=z.top,u=w+y,q=v+x,f=aC,e=this.defaults,H=e.aspectRatio,G={x:this.endX-this.startX,y:this.endY-this.startY};switch(H&&(G.X=G.y*H,G.Y=G.x/H),E){case"all":w+=G.x,v+=G.y;break;case"e":if(G.x>=0&&(u>=B||H&&(0>=v||q>=A))){f=aB;break}y+=G.x,H&&(x=y/H,v-=G.Y/2),0>y&&(E="w",y=0);break;case"n":if(G.y<=0&&(0>=v||H&&(0>=w||u>=B))){f=aB;break}x-=G.y,v+=G.y,H&&(y=x*H,w+=G.X/2),0>x&&(E="s",x=0);break;case"w":if(G.x<=0&&(0>=w||H&&(0>=v||q>=A))){f=aB;break}y-=G.x,w+=G.x,H&&(x=y/H,v+=G.Y/2),0>y&&(E="e",y=0);break;case"s":if(G.y>=0&&(q>=A||H&&(0>=w||u>=B))){f=aB;break}x+=G.y,H&&(y=x*H,w-=G.X/2),0>x&&(E="n",x=0);break;case"ne":if(H){if(G.y<=0&&(0>=v||u>=B)){f=aB;break}x-=G.y,v+=G.y,y=x*H}else{G.x>=0?B>u?y+=G.x:G.y<=0&&0>=v&&(f=aB):y+=G.x,G.y<=0?v>0&&(x-=G.y,v+=G.y):(x-=G.y,v+=G.y)}0>x&&(E="sw",x=0,y=0);break;case"nw":if(H){if(G.y<=0&&(0>=v||0>=w)){f=aB;break}x-=G.y,v+=G.y,y=x*H,w+=G.X}else{G.x<=0?w>0?(y-=G.x,w+=G.x):G.y<=0&&0>=v&&(f=aB):(y-=G.x,w+=G.x),G.y<=0?v>0&&(x-=G.y,v+=G.y):(x-=G.y,v+=G.y)}0>x&&(E="se",x=0,y=0);break;case"sw":if(H){if(G.x<=0&&(0>=w||q>=A)){f=aB;break}y-=G.x,w+=G.x,x=y/H}else{G.x<=0?w>0?(y-=G.x,w+=G.x):G.y>=0&&q>=A&&(f=aB):(y-=G.x,w+=G.x),G.y>=0?A>q&&(x+=G.y):x+=G.y}0>y&&(E="ne",x=0,y=0);break;case"se":if(H){if(G.x>=0&&(u>=B||q>=A)){f=aB;break}y+=G.x,x=y/H}else{G.x>=0?B>u?y+=G.x:G.y>=0&&q>=A&&(f=aB):y+=G.x,G.y>=0?A>q&&(x+=G.y):x+=G.y}0>y&&(E="nw",x=0,y=0);break;case"move":D.left+=G.x,D.top+=G.y,this.renderImage("move"),f=aB;break;case"zoom":e.zoomable&&(this.zoom(function(h,g,l,k,j,i){return(W(j*j+i*i)-W(l*l+k*k))/W(h*h+g*g)}(D.width,D.height,T(this.startX-this.startX2),T(this.startY-this.startY2),T(this.endX-this.endX2),T(this.endY-this.endY2))),this.endX2=this.startX2,this.endY2=this.startY2);break;case"crop":G.x&&G.y&&(F=this.$cropper.offset(),w=this.startX-F.left,v=this.startY-F.top,y=z.minWidth,x=z.minHeight,G.x>0?G.y>0?E="se":(E="ne",v-=x):G.y>0?(E="sw",w-=y):(E="nw",w-=y,v-=x),this.cropped||(this.cropped=aC,this.$dragger.removeClass(ap)))}f&&(z.width=y,z.height=x,z.left=w,z.top=v,this.directive=E,this.renderDragger()),this.startX=this.endX,this.startY=this.endY}},Y.TEMPLATE=function(d,c){return c=c.split(","),d.replace(/\d+/g,function(e){return c[e]})}('<0 6="5-container"><0 6="5-canvas"></0><0 6="5-dragger"><1 6="5-viewer"></1><1 6="5-8 8-h"></1><1 6="5-8 8-v"></1><1 6="5-face" 3-2="all"></1><1 6="5-7 7-e" 3-2="e"></1><1 6="5-7 7-n" 3-2="n"></1><1 6="5-7 7-w" 3-2="w"></1><1 6="5-7 7-s" 3-2="s"></1><1 6="5-4 4-e" 3-2="e"></1><1 6="5-4 4-n" 3-2="n"></1><1 6="5-4 4-w" 3-2="w"></1><1 6="5-4 4-s" 3-2="s"></1><1 6="5-4 4-ne" 3-2="ne"></1><1 6="5-4 4-nw" 3-2="nw"></1><1 6="5-4 4-sw" 3-2="sw"></1><1 6="5-4 4-se" 3-2="se"></1></0></0>',"div,span,directive,data,point,cropper,class,line,dashed"),Y.DEFAULTS={aspectRatio:"auto",autoCropArea:0.8,data:{},done:aG.noop,preview:"",multiple:aB,autoCrop:aC,dragCrop:aC,dashed:aC,modal:aC,movable:aC,resizable:aC,zoomable:aC,rotatable:aC,checkImageOrigin:aC,minWidth:0,minHeight:0,maxWidth:ay,maxHeight:ay,build:aA,built:aA,dragstart:aA,dragmove:aA,dragend:aA},Y.setDefaults=function(c){aG.extend(Y.DEFAULTS,c)},Y.other=aG.fn.cropper,aG.fn.cropper=function(e){var g,f=[].slice.call(arguments,1);return this.each(function(){var h,d=aG(this),c=d.data("cropper");c||d.data("cropper",c=new Y(this,e)),"string"==typeof e&&aG.isFunction(h=c[e])&&(g=h.apply(c,f))}),typeof g!==ax?g:this},aG.fn.cropper.Constructor=Y,aG.fn.cropper.setDefaults=Y.setDefaults,aG.fn.cropper.noConflict=function(){return aG.fn.cropper=Y.other,this}});a("cropper")}).addcss("modules/mplus/cropper/cropper.min.css","croppercss");